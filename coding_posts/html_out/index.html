
   <div class="maketitle">







<h2 class="titleHead">Primality Certification with Elliptic Curves</h2>
<div class="author" ><span
class="cmr-12">Ben Black</span></div><br />
<div class="date" ><span
class="cmr-12">December 11, 2019</span></div>
</div>
<h3 class="sectionHead"><span class="titlemark">1   </span> <a
id="x1-10001"></a>Primality Testing and Certification</h3>
<!--l. 48--><p class="noindent" >In modern day cryptography, the Miller-Rabin probabilistic primality test is
universally used for checking primality of general integers. It is much faster both
practically and algorithmically than any deterministic primality test, for any
reasonable bound on certainty. In fact, if we set our reasonable bound of
certainty to that of a hardware failure giving us an incorrect answer, then it is
still much, much faster. Because the chance of hardware failure increases
with increased computation time and memory usage, it can be argued that
Miller-Rabin can actually give a more certain result than some deterministic
tests.
</p><!--l. 50--><p class="indent" >   So how can general purpose deterministic primality tests prove their worth in this
imperfect world? The way I will discuss in this paper is the ability to generate short,
easily checkable proofs of primality, which can be verified much faster using much
simpler code than the generator of the proof. Even if this process of finding the
proof is fairly slow, then being able to check them may still have potential
uses.
</p>
<ul class="itemize1">
<li class="itemize">If you are using an internet service which generates primes, and you don&#8217;t
like the certainty guarantees of checksums to validate that there were no
errors in the transfer, then you could send both the prime, and the proof
of the prime, and verify the proof on on site.
</li>
<li class="itemize">If you wanted to store large databases of provable primes and didn&#8217;t trust
that the storage hardware would keep them correctly, you could also store



the proof of the prime, and just check it whenever you need to use the
prime.</li></ul>
<!--l. 57--><p class="indent" >   The best algorithm for finding such a proof of primality is ECPP, the elliptic
curve primality test discovered by Atkin and Morain. Although far slower than
Miller-Rabin, it is fast enough to operate on cryptographically important
primes in a few seconds. Unfortunately, ECPP is quite complicated and well
beyond the scope of this paper. However, the condition one needs to check
the primality certificate it generates is quite simple, just based on clever
analysis of orders in elliptic curves. I will introduce the theory of an elementary
version of the certificate the Pocklington criterion, then the elliptic curve
primality criterion, show a simple algorithm to generate these checks for
arbitrary primes, and then argue that these may be useful in real world
applications.
</p><!--l. 59--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2   </span> <a
id="x1-20002"></a>Pocklington primality test</h3>
<!--l. 61--><p class="noindent" >The elliptic curve primality condition is modeled after the Pocklington primality test.
I will explain it here in order to give some extra intuition.
</p><!--l. 63--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a
id="x1-30002.1"></a>Inspiration</h4>
<!--l. 65--><p class="noindent" >Fermat&#8217;s little theorem states that for <span
class="cmmi-10">p </span>prime, and <span
class="cmmi-10">a </span>coprime to <span
class="cmmi-10">p</span>,
</p>
<center class="math-display" >
<img
src="proj0x.svg" alt="a(p-1) = 1 (mod p)  " class="math-display"  /></center> We
wish to find a converse to this statement that gives some set of conditions that force
primality. To start, we know that (<span
class="cmmi-10">p </span><span
class="cmsy-10">- </span>1) is the smallest power of <span
class="cmmi-10">a </span>that equals 1.
Also, for <span
class="cmmi-10">m </span>composite, we know that <span
class="cmmi-10">a</span><sup><span
class="cmmi-7">l</span></sup> = 1<span
class="cmmi-10">&#x00A0;</span>(mod <span
class="cmmi-10">p</span>) for some <span
class="cmmi-10">l &#x003C; p </span><span
class="cmsy-10">- </span>1.
Specifically, we can use the fact that (<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;p</span><span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup> is cyclic to give the following
statement.
<div class="newtheorem">
<!--l. 67--><p class="noindent" ><span class="head">



<span
class="cmbx-10">Theorem</span><span
class="cmbx-10">&#x00A0;1</span> </span><span
class="cmti-10">If there exists an </span><span
class="cmmi-10">a </span><span
class="cmti-10">coprime to </span><span
class="cmmi-10">n </span><span
class="cmti-10">such that </span><span
class="cmmi-10">a</span><sup><span
class="cmmi-7">n</span><span
class="cmsy-7">-</span><span
class="cmr-7">1</span></sup> = 1<span
class="cmmi-10">&#x00A0;</span>(<span
class="cmti-10">mod</span> <span
class="cmmi-10">n</span>) <span
class="cmti-10">but</span>
<span
class="cmmi-10">a</span><sup><span
class="cmr-7">(</span><span
class="cmmi-7">n</span><span
class="cmsy-7">-</span><span
class="cmr-7">1)</span><span
class="cmmi-7">&#x2215;q</span></sup><span
class="cmmi-10">&#x2260;</span>1<span
class="cmmi-10">&#x00A0;</span>(<span
class="cmti-10">mod</span> <span
class="cmmi-10">n</span>) <span
class="cmti-10">for every prime </span><span
class="cmmi-10">q</span><span
class="cmsy-10">|</span><span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1<span
class="cmti-10">, then </span><span
class="cmmi-10">n </span><span
class="cmti-10">is prime.</span>
</p>
</div>
<!--l. 73--><p class="indent" >   We now have a condition for primality. However, there is the problem that we
need to factor <span
class="cmmi-10">n</span><span
class="cmsy-10">- </span>1, which is not generally computationally tractable. However, if we
already knew factors, then we could easily and quickly verify the primality of <span
class="cmmi-10">n </span>by
the above condition. So the certificate of primality of <span
class="cmmi-10">n </span>would simply be the
factorization of <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1.
</p><!--l. 77--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a
id="x1-40002.2"></a>Pocklington Criterion</h4>
<!--l. 80--><p class="noindent" >Pocklington&#8217;s insight was that if there was a large prime factor <span
class="cmmi-10">q </span>of <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1, then
there are some conditions that allow us to show primality only based on
the primality of <span
class="cmmi-10">q</span>, and even if we don&#8217;t know the other factors of <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1.
Formally,
</p>
<div class="newtheorem">
<!--l. 82--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Theorem</span><span
class="cmbx-10">&#x00A0;2</span> </span><span
class="cmti-10">Let </span><span
class="cmmi-10">n &#x003E; </span>1 <span
class="cmti-10">be an integer, </span><span
class="cmmi-10">q </span><span
class="cmti-10">a prime divisor of </span><span
class="cmmi-10">n</span><span
class="cmsy-10">-</span>1<span
class="cmti-10">, and </span><span
class="cmmi-10">a </span><span
class="cmti-10">coprime</span>
<span
class="cmti-10">to </span><span
class="cmmi-10">n</span><span
class="cmti-10">. If</span>
</p>
<center class="math-display" >
<img
src="proj1x.svg" alt="   &#x221A; --
q &#x003E;  n - 1
" class="math-display"  /></center> <span
class="cmti-10">and</span>
<center class="math-display" >



<img
src="proj2x.svg" alt="gcd(a(n-1)&#x2215;q - 1,n) = 1
" class="math-display"  /></center> <span
class="cmti-10">Then </span><span
class="cmmi-10">n </span><span
class="cmti-10">is prime</span>
</div>
<!--l. 91--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a
id="x1-50002.3"></a>Proof of Pocklington Criterion</h4>
<!--l. 95--><p class="noindent" >Suppose <span
class="cmmi-10">n </span>is composite. Then there must be a <span
class="cmmi-10">p </span><span
class="cmsy-10">&#x2264;</span><img
src="proj3x.svg" alt="&#x221A; --
n"  class="sqrt"  /> that divides <span
class="cmmi-10">n</span>.
</p><!--l. 97--><p class="indent" >   We are going to look at the order of <span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub> which is, <span
class="cmmi-10">p</span><span
class="cmsy-10">- </span>1, to reach a contradiction.
</p><!--l. 99--><p class="indent" >   We have
</p>
<center class="math-display" >
<img
src="proj4x.svg" alt=" n-1
a    = 1 (mod p)  " class="math-display"  /></center>
Since <span
class="cmmi-10">q </span>is prime, and <span
class="cmmi-10">q &#x003E;</span> <img
src="proj5x.svg" alt="&#x221A;--
n"  class="sqrt"  /> <span
class="cmsy-10">- </span>1 <span
class="cmsy-10">&#x2265; </span><span
class="cmmi-10">p </span><span
class="cmsy-10">- </span>1, <span
class="cmmi-10">q </span>is coprime to <span
class="cmmi-10">p </span><span
class="cmsy-10">- </span>1. Therefore, <span
class="cmmi-10">q </span>is
multiplicatively invertible in (<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;</span>(<span
class="cmmi-10">p</span><span
class="cmsy-10">- </span>1)<span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup>, and so we can just multiply the exponent
of <span
class="cmmi-10">a </span>by the inverse of <span
class="cmmi-10">q</span>
<center class="math-display" >
<img
src="proj6x.svg" alt="(a(n- 1))1&#x2215;q = a(n-1)&#x2215;q = 1 (mod p)  " class="math-display"  /></center>
Which contradicts the condition gcd(<span
class="cmmi-10">a</span><sup><span
class="cmr-7">(</span><span
class="cmmi-7">n</span><span
class="cmsy-7">-</span><span
class="cmr-7">1)</span><span
class="cmmi-7">&#x2215;q</span></sup> <span
class="cmsy-10">- </span>1<span
class="cmmi-10">,n</span>) = 1. So <span
class="cmmi-10">n </span>is prime.



<!--l. 106--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a
id="x1-60002.4"></a>Proof Certificate using Pocklington&#8217;s Criterion</h4>
<!--l. 108--><p class="noindent" >Note that factoring <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1 is trivial if it factors into 2<span
class="cmmi-10">p</span>, where <span
class="cmmi-10">p </span>is prime. Also note
that we get the size condition of Pockington&#8217;s criterion, <span
class="cmmi-10">p &#x003E;</span> <img
src="proj7x.svg" alt="&#x221A;n--"  class="sqrt"  /><span
class="cmsy-10">- </span>1, for free because
is <span
class="cmmi-10">p </span>such a large factor of <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1.
</p><!--l. 111--><p class="indent" >   Understanding that not all <span
class="cmmi-10">n </span>are of this sort, we can still use Pockington&#8217;s
criterion to say that if gcd(<span
class="cmmi-10">a</span><sup><span
class="cmr-7">(</span><span
class="cmmi-7">n</span><span
class="cmsy-7">-</span><span
class="cmr-7">1)</span><span
class="cmmi-7">&#x2215;q</span></sup> <span
class="cmsy-10">- </span>1<span
class="cmmi-10">,n</span>) = gcd(<span
class="cmmi-10">a</span><sup><span
class="cmr-7">2</span></sup> <span
class="cmsy-10">- </span>1<span
class="cmmi-10">,n</span>) = 1, and that <span
class="cmmi-10">p </span>is prime
then <span
class="cmmi-10">n </span>is prime. Of course you need to check if <span
class="cmmi-10">p </span>is prime, but hopefully you can use
the same method to check that. And so on until you create a decreasing chain of
primes
</p>
<center class="math-display" >
<img
src="proj8x.svg" alt="n &#x003E; p0 &#x003E; p1 &#x003E; ...&#x003E; psmall  " class="math-display"  /></center>
that demonstrate the previous number&#8217;s primality.<div class="mdframed" id="mdframed-1">
<div class="newtheorem">
<!--l. 121--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Example</span><span
class="cmbx-10">&#x00A0;1</span> </span><span
class="cmti-10">Creating a full proof of primality for </span><span
class="cmmi-10">n </span>= 47<span
class="cmti-10">,</span>
</p>
</div>
<div class="tabular"> <table id="TBL-2" class="tabular"
cellspacing="0" cellpadding="0"
><colgroup id="TBL-2-1g"><col
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col
id="TBL-2-2" /></colgroup><colgroup id="TBL-2-3g"><col
id="TBL-2-3" /></colgroup><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"
class="td11"><span
class="cmmi-10">n</span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-1-2"
class="td11"><span
class="cmmi-10">q </span>= (<span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1)<span
class="cmmi-10">&#x2215;</span>2</td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-1-3"
class="td11">gcd(<span
class="cmmi-10">a</span><sup><span
class="cmr-7">2</span></sup> <span
class="cmsy-10">- </span>1<span
class="cmmi-10">,n</span>)</td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"
class="td11">47</td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-2-2"
class="td11">     23       </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-2-3"
class="td11">           1</td></tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"
class="td11">23</td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-3-2"
class="td11"> 11 </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-3"
class="td11"> 1</td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"
class="td11">11</td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-4-2"
class="td11">     5        </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-4-3"
class="td11">           1</td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"
class="td11">5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-5-2"
class="td11">     2        </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-5-3"
class="td11">           1</td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-1"
class="td11">  </td></tr></table></div>
<!--l. 137--><p class="noindent" >2 is clearly prime, so each <span
class="cmmi-10">n </span>is in turn prime, and so 47 is prime.</p>
</div>
<!--l. 142--><p class="indent" >   Even though this method does not work for general primes, we will make a similar
method work using elliptic curves. The key will be that although there is only one
(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup>, there are many elliptic curves over <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>, and some of them will have order
2<span
class="cmmi-10">p</span>, where <span
class="cmmi-10">p </span>is prime.
</p><!--l. 144--><p class="noindent" >
</p>



<h3 class="sectionHead"><span class="titlemark">3   </span> <a
id="x1-70003"></a>Elliptic Curves Overview</h3>
<!--l. 146--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a
id="x1-80003.1"></a>Introductory Sources</h4>
<!--l. 148--><p class="noindent" >There are many fabulous introductions to the basics of elliptic curves, including
</p>
<ul class="itemize1">
<li class="itemize">The fabulous explanation by Andrea Corbellini. It includes interactive
components  and  a  thorough  overview  that  does  not  require  much
background in algebra. Posted here:
<!--l. 153--><p class="noindent" ><a
href="http://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/#elliptic-curves" class="url" ><span
class="cmtt-10">http://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/#elliptic-curves</span></a>
</p></li>
<li class="itemize">Joseph H. Silverman John T. Tate Rational Points on Elliptic Curves</li></ul>
<!--l. 161--><p class="indent" >   As these are better written than I could ever manage, I not attempt to introduce
elliptic curves in a comprehensive manner, especially since most of the theory is
unnecessary for our purpose. Instead, I will just cover the important topics such as
order of elliptic curves.
</p><!--l. 163--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a
id="x1-90003.2"></a>Refresher</h4>
<!--l. 165--><p class="noindent" >Recall that elliptic curves are defined in a plane of <span
class="msbm-10">F</span><sup><span
class="cmr-7">2</span></sup>, where <span
class="msbm-10">F </span>is some field, as
formulas
</p><!--l. 167--><p class="indent" >
</p>
<center class="math-display" >
<img
src="proj9x.svg" alt=" 2   3
y = x + ax + b where a,b &#x2208; F
" class="math-display"  /></center>
<!--l. 169--><p class="indent" >   There is a group operation +, with identity <span
class="msbm-10">O </span>which is an additional point on the
elliptic curve that is not on the plane. It is often referred to as the point at
infinity. You can add points (<span
class="cmmi-10">x</span><sub><span
class="cmr-7">1</span></sub><span
class="cmmi-10">,y</span><sub><span
class="cmr-7">1</span></sub>) and (<span
class="cmmi-10">x</span><sub><span
class="cmr-7">2</span></sub><span
class="cmmi-10">,y</span><sub><span
class="cmr-7">2</span></sub>) on elliptic curves by the
formulas



</p>
<center class="par-math-display" >
<img
src="proj10x.svg" alt="     {                 }
yx22--yx11, if x1 &#x2044;= x2
m  =   3x21+a, if x = x
2y1      1    2
" class="par-math-display"  /></center>
<!--l. 176--><p class="nopar" >
</p><!--l. 178--><p class="indent" >
</p>
<center class="math-display" >
<img
src="proj11x.svg" alt="x  = (m2 - x  - x )
r         1    2
" class="math-display"  /></center>
<center class="math-display" >
<img
src="proj12x.svg" alt="yr = - (y1 + m (xr - x1))
" class="math-display"  /></center>
<!--l. 181--><p class="noindent" >And (<span
class="cmmi-10">x</span><sub><span
class="cmmi-7">r</span></sub><span
class="cmmi-10">,y</span><sub><span
class="cmmi-7">r</span></sub>) is the result.
</p><!--l. 183--><p class="indent" >   Finally, multiplication of a point by an integer <span
class="cmmi-10">m </span>is repeated addition of the point
by itself <span
class="cmmi-10">m </span>times.
</p><!--l. 185--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a
id="x1-100003.3"></a>Calculating Elliptic Curve Arithmetic</h4>
<!--l. 187--><p class="noindent" >Calculating these formulas is difficult and error prone to work out by hand, and is
not pleasant even using an ordinary calculator. I wrote a python file to support this
paper, and in it is an <span
class="cmtt-10">add </span>function and a <span
class="cmtt-10">mul </span>function to help calculate addition and
multiplication of elliptic curves.



</p><!--l. 189--><p class="indent" >   It can be found here: <a
href="https://github.com/weepingwillowben/num_proj/blob/master/prime_check.py" class="url" ><span
class="cmtt-10">https://github.com/weepingwillowben/num_proj/blob/master/prime_check.py</span></a>.
It uses the gmpy2 math library for modular arithmetic, and so unfortunately, it
is non&#8211;trivial to install. Installation instructions are at the top of the file.
All elliptic curve examples shown were made using this code to calculate
operations.
</p><!--l. 192--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a
id="x1-110003.4"></a>Note about <span
class="cmmi-10">E</span>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>)</h4>
<!--l. 194--><p class="noindent" >Now that we are getting into the main subject of the paper, I have to mention a
problem with elliptic curves in these sorts of proofs. That is, elliptic curves are only
well defined over fields, and <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124; </span>is not a field unless <span
class="cmmi-10">n </span>is prime. However, it turns
out to not be too much of a problem, as operations work as you might expect them
to, if they are well defined.
</p><!--l. 196--><p class="indent" >   In particular, let <span
class="cmmi-10">L,M </span><span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>). Define <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> = (<span
class="cmmi-10">x</span><sub><span
class="cmmi-7">p</span></sub><span
class="cmmi-10">,y</span><sub><span
class="cmmi-7">p</span></sub>) <span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>), and
<span
class="msbm-10">O</span><sub><span
class="cmmi-7">p</span></sub> = <span
class="msbm-10">O </span><span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>). Then if <span
class="cmmi-10">L </span>+ <span
class="cmmi-10">M </span>is defined, then (<span
class="cmmi-10">L </span>+ <span
class="cmmi-10">M</span>)<sub><span
class="cmmi-7">p</span></sub> = <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> + <span
class="cmmi-10">M</span><sub><span
class="cmmi-7">p</span></sub>.
</p><!--l. 198--><p class="indent" >   So how do we check if the group operation is well defined? Recall the formula for
the slope of the line
</p>
<center class="par-math-display" >
<img
src="proj13x.svg" alt="     { y2-y1, if x &#x2044;= x }
m  =   x32x-21x+1a     1    2
-2y1-, if x1 = x2
" class="par-math-display"  /></center>
<!--l. 205--><p class="nopar" >
</p><!--l. 207--><p class="indent" >   This operation fails in <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124; </span>if the denominator of the respective formula is not
invertible <span
class="cmmi-10">&#x00A0;</span>(mod <span
class="cmmi-10">n</span>). This occurs exactly when
</p>
<center class="par-math-display" >
<img
src="proj14x.svg" alt="{                         }
gcd(x2 - x1,n), if x1 &#x2044;= x2 &#x2044;= 1
gcd(2y1,n),     if x1 = x2
" class="par-math-display"  /></center>
<!--l. 215--><p class="nopar" >
</p><!--l. 217--><p class="indent" >   It turns out that <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124; </span>is near enough to a field that this is the only
way in which the elliptic curve assumptions fail, so this is an if and only
if.
</p><!--l. 219--><p class="indent" >   In the context of factoring and primality proving, the failure of addition reveals
that <span
class="cmmi-10">n </span>is not prime, and in fact, gives a factor of <span
class="cmmi-10">n</span>, and so we don&#8217;t have to continue
to try to work in <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124; </span>anymore. So the failure condition for addition in <span
class="cmmi-10">E</span>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>)
actually helps our work, instead of limiting us.



</p><!--l. 222--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4   </span> <a
id="x1-120004"></a>Elliptic Primality Testing</h3>
<!--l. 224--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a
id="x1-130004.1"></a>Approach</h4>
<!--l. 226--><p class="noindent" >For the Pocklington criterion, we examined the order of the cyclic group (<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;p</span><span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup> in
order to prove primality. In (<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup>, the order is (<span
class="cmmi-10">n</span><span
class="cmsy-10">- </span>1). So we look at the order of
elliptic curves in order to find a similar result.
</p><!--l. 228--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a
id="x1-140004.2"></a>Orders of Elliptic Curves</h4>
<!--l. 230--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1   </span> <a
id="x1-150004.2.1"></a>Theory</h5>
<!--l. 231--><p class="noindent" >The order of a point on an elliptic curve, denoted #<span
class="cmmi-10">L</span>, is the number of times you can
add a point <span
class="cmmi-10">L </span><span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>) to itself before getting back the identity <span
class="msbm-10">O</span>. Formally, #<span
class="cmmi-10">L</span>
is the smallest <span
class="cmmi-10">m </span>such that <span
class="cmmi-10">mL </span>= <span
class="msbm-10">O</span>. Note that this implies that if you multiply <span
class="cmmi-10">L</span>
by <span
class="cmmi-10">m </span>+ 1, you get back <span
class="cmmi-10">L</span>, and (<span
class="cmmi-10">m </span>+ 2)<span
class="cmmi-10">L </span>= 2<span
class="cmmi-10">L</span>, and so on, and so you can
think of the multiplicand operating in <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;m</span><span
class="msbm-10">&#x2124;</span>. This is a special case of the
fundamental theorem of finite abelian groups. Alternatively, <span
class="cmmi-10">mL </span>= <span
class="msbm-10">O </span>can
be though of as Fermat&#8217;s little theorem for elliptic curves. Order analysis
on points forms the basis for the primality test, mirroring Pocklington&#8217;s
criterion.
</p><!--l. 233--><p class="indent" >   Order on the curve itself is defined very differently. For <span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>), the order of an
elliptic curve, denoted #<span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>) is the number of points in the elliptic curve. For
any <span
class="cmmi-10">L</span><span
class="cmmi-10">&#x2260;</span><span
class="msbm-10">O </span><span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>), #<span
class="cmmi-10">L </span>divides #<span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>).
</p><!--l. 236--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><span class="titlemark">4.2.2   </span> <a
id="x1-160004.2.2"></a>Algorithm</h5>
<!--l. 238--><p class="noindent" >It turns out that you can compute #<span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>) by counting the number of points on
the elliptic curve in <span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub><sup><span
class="cmr-7">2</span></sup>, plus the point at infinity. For a small <span
class="cmmi-10">p</span>, one can count the
points by just looking at the formula
</p><!--l. 240--><p class="indent" >



</p>
<center class="math-display" >
<img
src="proj15x.svg" alt="     &#x2218; ----------
y = �  x3 + ax+ b
" class="math-display"  /></center>
<!--l. 242--><p class="indent" >   And checking counting how many times <span
class="cmmi-10">y </span>is an integer for all values
<span
class="cmmi-10">x </span><span
class="cmsy-10">&#x2208; </span><span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>.</p>
<div class="mdframed" id="mdframed-2">
<!--l. 250--><p class="noindent" ></p><div class="newtheorem">
<!--l. 250--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Example</span><span
class="cmbx-10">&#x00A0;2</span> </span><span
class="cmti-10">Counting points in </span><span
class="cmmi-10">E</span><sub><span
class="cmr-7">1</span><span
class="cmmi-7">,</span><span
class="cmr-7">1</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub>)<span
class="cmti-10">,</span>
</p>
</div>
<!--l. 254--><p class="noindent" >We have <span
class="cmmi-10">x </span>= 0<span
class="cmmi-10">,</span>1<span
class="cmmi-10">,</span>2<span
class="cmmi-10">,</span>3<span
class="cmmi-10">,</span>4, and so <span
class="cmmi-10">x</span><sup><span
class="cmr-7">3</span></sup> + <span
class="cmmi-10">x </span>+ 1 = 1<span
class="cmmi-10">,</span>3<span
class="cmmi-10">,</span>1<span
class="cmmi-10">,</span>1<span
class="cmmi-10">,</span>4, respectively.
</p><!--l. 256--><p class="noindent" >The numbers which are quadratic residues, i.e. have a non-zero square roots in <span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub> are
1 and 4. So we have 4 values of <span
class="cmsy-10">�</span><span
class="cmmi-10">y</span>, each of which non-zero, and so are distinct. So we
have 8 points in total, 9 including <span
class="msbm-10">O</span>.
</p><!--l. 258--><p class="noindent" >So #<span
class="cmmi-10">E</span><sub><span
class="cmr-7">1</span><span
class="cmmi-7">,</span><span
class="cmr-7">1</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub>) = 9.</p>
</div>
<!--l. 262--><p class="indent" >   Lets check the above theorem that the order is exactly the number of points on
the curve.</p>
<div class="mdframed" id="mdframed-3">
<!--l. 270--><p class="noindent" ></p><div class="newtheorem">
<!--l. 270--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Example</span><span
class="cmbx-10">&#x00A0;3</span> </span><span
class="cmti-10">Checking that point order divides number of points in </span><span
class="cmmi-10">E</span><sub><span
class="cmr-7">1</span><span
class="cmmi-7">,</span><span
class="cmr-7">1</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub>)<span
class="cmti-10">,</span>
</p>
</div>
<!--l. 274--><p class="noindent" >Take (0<span
class="cmmi-10">,</span>1) <span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmr-7">1</span><span
class="cmmi-7">,</span><span
class="cmr-7">1</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub>). Then perhaps using the point addition calculator here:
<a
href="https://cdn.rawgit.com/andreacorbellini/ecc/920b29a/interactive/modk-add.html" class="url" ><span
class="cmtt-10">https://cdn.rawgit.com/andreacorbellini/ecc/920b29a/interactive/modk-add.html</span></a>,
we can compute that
</p><!--l. 276--><p class="noindent" >(0<span
class="cmmi-10">,</span>1) + (0<span
class="cmmi-10">,</span>1) = (4<span
class="cmmi-10">,</span>2) <br
class="newline" />(4<span
class="cmmi-10">,</span>2) + (0<span
class="cmmi-10">,</span>1) = (2<span
class="cmmi-10">,</span>1) <br
class="newline" />(2<span
class="cmmi-10">,</span>1) + (0<span
class="cmmi-10">,</span>1) = (3<span
class="cmmi-10">,</span>4) <br
class="newline" />(3<span
class="cmmi-10">,</span>4) + (0<span
class="cmmi-10">,</span>1) = (3<span
class="cmmi-10">,</span>1) <br
class="newline" />(3<span
class="cmmi-10">,</span>1) + (0<span
class="cmmi-10">,</span>1) = (2<span
class="cmmi-10">,</span>4) <br
class="newline" />(2<span
class="cmmi-10">,</span>4) + (0<span
class="cmmi-10">,</span>1) = (4<span
class="cmmi-10">,</span>3) <br
class="newline" />(4<span
class="cmmi-10">,</span>3) + (0<span
class="cmmi-10">,</span>1) = (0<span
class="cmmi-10">,</span>4) <br
class="newline" />(0<span
class="cmmi-10">,</span>4) + (0<span
class="cmmi-10">,</span>1) = <span
class="msbm-10">O</span>
</p><!--l. 293--><p class="noindent" >Which is equal to 9 <span
class="cmsy-10">&#x00D7; </span>(0<span
class="cmmi-10">,</span>1), so we confirmed that #(0<span
class="cmmi-10">,</span>1) = 9<span
class="cmmi-10">&#x00A0;</span><span
class="cmsy-10">|</span><span
class="cmmi-10">&#x00A0;</span>9, as desired.</p>
</div>
<!--l. 298--><p class="indent" >   This counting algorithm is impractical if <span
class="cmmi-10">p </span>is large. Luckily, we have polynomial
time algorithms for this, Schoof&#8217;s algorithm, and it&#8217;s variants and improvements. So
this is a tractable problem. However, Schoof&#8217;s algorithm is extremely complicated, as
well as rather slow, so I will not cover it here.
</p><!--l. 300--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a
id="x1-170004.3"></a>Bounds on Orders of Elliptic Curves</h4>
<!--l. 302--><p class="noindent" >Although counting precisely how many points are on a particular curve is a challenge,
Hasse discovered useful bounds for it.
</p><!--l. 304--><p class="indent" >   In particular, for <span
class="cmmi-10">N </span>the number of points on an elliptic curve over <span
class="msbm-10">F</span><sub><span
class="cmmi-7">q</span></sub>,
</p>
<center class="math-display" >
<img
src="proj16x.svg" alt="               &#x221A;-
|N - (q+ 1)| &#x2264; 2 q
" class="math-display"  /></center>
<!--l. 308--><p class="indent" >   We will use this in order to derive a contradiction that will prove the primality of
<span
class="cmmi-10">N</span>.
</p><!--l. 310--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a
id="x1-180004.4"></a>Elliptic Primality Criterion</h4>
<!--l. 312--><p class="noindent" >We are going to use this order exactly like we used <span
class="cmmi-10">n </span><span
class="cmsy-10">- </span>1 in the (<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;p</span><span
class="msbm-10">&#x2124;</span>)<sup><span
class="cmsy-7">*</span></sup> based
primality proof, and establish a nearly identical criterion.
</p><!--l. 314--><p class="noindent" ></p><div class="newtheorem">
<!--l. 314--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Theorem</span><span
class="cmbx-10">&#x00A0;3</span> </span><span
class="cmti-10">Let </span><span
class="cmmi-10">n </span><span
class="cmti-10">be an integer not divisible by 2 or 3. Let </span><span
class="cmmi-10">A,B </span><span
class="cmsy-10">&#x2208; </span><span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124; </span><span
class="cmti-10">such</span>
<span
class="cmti-10">that</span> gcd(4<span
class="cmmi-10">A</span><sup><span
class="cmr-7">3</span></sup> + 27<span
class="cmmi-10">B</span><sup><span
class="cmr-7">2</span></sup><span
class="cmmi-10">,n</span>) = 1<span
class="cmti-10">, and let </span><span
class="cmmi-10">L</span><span
class="cmmi-10">&#x2260;</span><span
class="msbm-10">O  </span><span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>)<span
class="cmti-10">. If there exists a</span>
<span
class="cmti-10">prime </span><span
class="cmmi-10">q &#x003E; </span>(<img
src="proj17x.svg" alt="4&#x221A; --
n"  class="root" align="middle"  /> + 1)<sup><span
class="cmr-7">2</span></sup> <span
class="cmti-10">such that </span><span
class="cmmi-10">qL </span>= <span
class="msbm-10">O</span><span
class="cmti-10">, then </span><span
class="cmmi-10">n </span><span
class="cmti-10">is prime.</span>
</p>
</div>



<div class="mdframed" id="mdframed-4">
<!--l. 322--><p class="noindent" ></p><div class="newtheorem">
<!--l. 322--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Example</span><span
class="cmbx-10">&#x00A0;4</span> </span><span
class="cmti-10">Checking primality of </span>103
</p>
</div>
<!--l. 326--><p class="noindent" >Lets take <span
class="cmmi-10">L </span>= (85<span
class="cmmi-10">,</span>81) <span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A</span><span
class="cmr-7">=72</span><span
class="cmmi-7">,B</span><span
class="cmr-7">=93</span></sub>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;</span>103<span
class="msbm-10">&#x2124;</span>). Then we can calculate that
53 <span
class="cmsy-10">&#x00D7; </span><span
class="cmmi-10">L </span>= <span
class="msbm-10">O</span>, and so by the theorem, 103 is prime if 53 is prime.</p>
</div>
<!--l. 331--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a
id="x1-190004.5"></a>Proof</h4>
<!--l. 333--><p class="noindent" >Proof by contradiction, assume some prime <span
class="cmmi-10">p</span><span
class="cmsy-10">|</span><span
class="cmmi-10">n</span>. Mirroring the Pocklington criterion
proof, we are going to look at the order of <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> <span
class="cmsy-10">&#x2208; </span><span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>), which is the point <span
class="cmmi-10">L</span>
defined over <span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub> instead of <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>.
</p><!--l. 336--><p class="indent" >
</p><ol  class="enumerate1" >
<li
class="enumerate" id="x1-19002x1">gcd(4<span
class="cmmi-10">A</span><sup><span
class="cmr-7">3</span></sup> + 27<span
class="cmmi-10">B</span><sup><span
class="cmr-7">2</span></sup><span
class="cmmi-10">,n</span>) = 1 ensures that the elliptic curve is well defined over
<span
class="cmmi-10">E</span><sub><span
class="cmmi-7">A,B</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub>), even though we don&#8217;t know <span
class="cmmi-10">p</span>, because if <span
class="cmmi-10">p</span><span
class="cmsy-10">|</span>4<span
class="cmmi-10">A</span><sup><span
class="cmr-7">3</span></sup> + 27<span
class="cmmi-10">B</span><sup><span
class="cmr-7">2</span></sup>, then
<span
class="cmmi-10">p</span><span
class="cmsy-10">|</span>gcd(4<span
class="cmmi-10">A</span><sup><span
class="cmr-7">3</span></sup> + 27<span
class="cmmi-10">B</span><sup><span
class="cmr-7">2</span></sup><span
class="cmmi-10">,n</span>).
</li>
<li
class="enumerate" id="x1-19004x2">The <span
class="cmmi-10">n </span>does not divide 2 or 3 is going to be necessary for a later theorem
that we need to show that we can actually find such an elliptic curve in
polynomial time. But it isn&#8217;t necessary for the criterion.</li></ol>
<!--l. 341--><p class="noindent" >Now the meat of the proof, using the notation from the <span
class="cmmi-10">E</span>(<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>) section of the
paper.
</p><!--l. 343--><p class="noindent" ><span
class="cmmi-10">qL</span><sub><span
class="cmmi-7">p</span></sub> = (<span
class="cmmi-10">qL</span>)<sub><span
class="cmmi-7">p</span></sub>, by the elliptic curve behavior over <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>.
</p><!--l. 345--><p class="noindent" ><span
class="cmmi-10">qL </span>= <span
class="msbm-10">O </span>by the criterion, and so <span
class="cmmi-10">qL</span><sub><span
class="cmmi-7">p</span></sub> = <span
class="msbm-10">O</span><sub><span
class="cmmi-7">p</span></sub> = <span
class="msbm-10">O</span>, again by behavior over
<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>.
</p><!--l. 347--><p class="noindent" >But since <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub><span
class="cmmi-10">&#x2260;</span><span
class="msbm-10">O </span>and <span
class="cmmi-10">q </span>is prime, the order of <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> must be <span
class="cmmi-10">q</span>. After all, if it were a
number <span
class="cmmi-10">t </span>smaller than <span
class="cmmi-10">q </span>then we could talk about <span
class="cmmi-10">qL </span>in terms of <span
class="cmmi-10">q</span><span
class="cmmi-10">&#x00A0;</span>(mod <span
class="cmmi-10">t</span>), due to
the fundamental theorem of albelian groups, where 0<span
class="cmmi-10">&#x00A0;</span>(mod <span
class="cmmi-10">t</span>) maps to <span
class="msbm-10">O</span>. But <span
class="cmmi-10">q </span>is
coprime to <span
class="cmmi-10">t</span>, so <span
class="cmmi-10">q </span>couldn&#8217;t be 0, and so <span
class="cmmi-10">qL </span>couldn&#8217;t be <span
class="msbm-10">O </span>unless <span
class="cmmi-10">t </span>= 1<span style="margin-left:2.77695pt" class="tmspace"></span><img
src="proj18x.svg" alt="=&#x21D2;"  class="Longrightarrow"  /><span style="margin-left:2.77695pt" class="tmspace"></span><span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> = <span
class="msbm-10">O</span>.
But that is not true, by assumption. So indeed, the order of <span
class="cmmi-10">L</span><sub><span
class="cmmi-7">p</span></sub> must be
<span
class="cmmi-10">q</span>.
</p><!--l. 349--><p class="noindent" >But by Hasse&#8217;s bound on the order of elliptic curves,
</p><!--l. 351--><p class="indent" >



</p>
<center class="math-display" >
<img
src="proj19x.svg" alt="#Lp &#x2264; #E&#x221A;A,B (Fp)  De finition of order on Lp
&#x2264; (  p+ 1)2            Hasse&#8217;s bound
&#x2264; (&#x221A;4n-+ 1)2            Condition on p
&#x003C; q                    Condition on q
" class="math-display"  /></center>
<!--l. 357--><p class="noindent" >Which is a contradiction, so <span
class="cmmi-10">n </span>must be prime.
</p><!--l. 359--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.6   </span> <a
id="x1-200004.6"></a>Chains of Conditions</h4>
<!--l. 361--><p class="noindent" >Like I showed earlier with the Pocklington Criterion, these conditional proof of
primality based on a smaller number&#8217;s primality can be chained together to create a
complete certificate of primality.</p>
<div class="mdframed" id="mdframed-5">
<!--l. 369--><p class="noindent" ></p><div class="newtheorem">
<!--l. 369--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Example</span><span
class="cmbx-10">&#x00A0;5</span> </span><span
class="cmti-10">Checking that point counting and order are equivalent in </span><span
class="cmmi-10">E</span><sub><span
class="cmr-7">1</span><span
class="cmmi-7">,</span><span
class="cmr-7">1</span></sub>(<span
class="msbm-10">F</span><sub><span
class="cmr-7">5</span></sub>)<span
class="cmti-10">,</span>
</p>
</div>
<!--l. 373--><p class="noindent" >We can extend the example from before to also include the conditions that show that
53 is prime.
</p>
<div class="tabular"> <table id="TBL-3" class="tabular"
cellspacing="0" cellpadding="0"
><colgroup id="TBL-3-1g"><col
id="TBL-3-1" /></colgroup><colgroup id="TBL-3-2g"><col
id="TBL-3-2" /></colgroup><colgroup id="TBL-3-3g"><col
id="TBL-3-3" /></colgroup><colgroup id="TBL-3-4g"><col
id="TBL-3-4" /></colgroup><colgroup id="TBL-3-5g"><col
id="TBL-3-5" /></colgroup><colgroup id="TBL-3-6g"><col
id="TBL-3-6" /></colgroup><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-1"
class="td11"> <span
class="cmmi-10">n </span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-2"
class="td11">  <span
class="cmmi-10">L   </span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-3"
class="td11"><span
class="cmmi-10">A</span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-4"
class="td11"><span
class="cmmi-10">B</span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-5"
class="td11"> <span
class="cmmi-10">q </span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-6"
class="td11"><span
class="cmmi-10">qL</span></td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-1"
class="td11">103</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-2"
class="td11">(85,81)</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-3"
class="td11">72</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-4"
class="td11">93</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-5"
class="td11">53</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-6"
class="td11"> <span
class="msbm-10">O </span></td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-1"
class="td11"> 53 </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-2"
class="td11"> (4,30) </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-3"
class="td11">37</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-4"
class="td11">52</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-5"
class="td11">29</td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-6"
class="td11"> <span
class="msbm-10">O </span></td>
</tr><tr
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr
style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-4-1"
class="td11">   </td></tr></table></div>
<!--l. 382--><p class="noindent" >Now, we can easily check that 103 is prime if 29 is prime using the criterion.</p>
</div>
<!--l. 387--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.7   </span> <a
id="x1-210004.7"></a>Implementation</h4>



<!--l. 389--><p class="noindent" >Included in the my python code is a <span
class="cmtt-10">check</span><span
class="cmtt-10">_prime </span>function that takes in a
curve, point, assumed prime, and number to check and outputs whether
it is prime using the method described above. If you are good with code,
you should be able to play around with it and see that it works exactly as
described above. There is also a <span
class="cmtt-10">check</span><span
class="cmtt-10">_certificate </span>that checks a list of such
information.
</p><!--l. 391--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">5   </span> <a
id="x1-220005"></a>Generating the Primality Proof</h3>
<!--l. 393--><p class="noindent" >The ability to check this condition would not be useful in a practical setting unless
we had the ability to generate the proof conditions for general numbers in polynomial
time. There are two main ways of finding the curves and points which meet the
criterion. The first one, the Goldwasser&#8211;Kilian algorithm, is much simpler, and so
that is what I will describe in depth. The second one is much faster and is what is
used in practice, but also much more complicated.
</p><!--l. 395--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a
id="x1-230005.1"></a>Goldwasser-&#8211;Kilian Algorithm Overview</h4>
<!--l. 397--><p class="noindent" >This algorithm is based on guess and check. Naively, We want to just guess a curve, a
point <span
class="cmmi-10">L</span>, and large prime <span
class="cmmi-10">q </span>such that <span
class="cmmi-10">qL </span>= <span
class="msbm-10">O</span>. In this algorithm, we will still end
up guessing the curve and the point, but instead of finding the prime by
guessing, we can use the relationship between point counting and order and do
fast point counting using Schoof&#8217;s algorithm in order to find our candidate
<span
class="cmmi-10">q</span>.
</p><!--l. 399--><p class="indent" >   Choose <span
class="cmmi-10">L</span>, a random point on <span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>, and choose a random elliptic curve <span
class="cmmi-10">E </span>over
<span
class="msbm-10">&#x2124;</span><span
class="cmmi-10">&#x2215;n</span><span
class="msbm-10">&#x2124;</span>, such that <span
class="cmmi-10">L </span>is in <span
class="cmmi-10">E</span>. Count the number of points <span
class="cmmi-10">m</span>. Check if <span
class="cmmi-10">m </span>satisfies 2<span
class="cmmi-10">q</span>,
with <span
class="cmmi-10">q </span>a probable prime (checking with Miller-Rabin). Also check that <span
class="cmmi-10">qL </span>= <span
class="msbm-10">O</span>. If
both hold, then you have found the point, curve, and prime number that satisfy the
condition.
</p><!--l. 402--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a
id="x1-240005.2"></a>Implementation</h4>
<!--l. 404--><p class="noindent" >To make this more concrete, I made a really inefficient version of this algorithm
based on the description in <span class="underline">An Overview of Elliptic Curve Primality Proving</span> by
Frank Li <span class="cite">[<a
href="#XStanfordAlgo">1</a>]</span>.
</p><!--l. 406--><p class="indent" >   The <span
class="cmtt-10">gen</span><span
class="cmtt-10">_and</span><span
class="cmtt-10">_check</span><span
class="cmtt-10">_certificate </span>function prints out the certificate and then
checks it. It uses an exponential time point counting function instead of Schoof&#8217;s
algorithm, and an exponential time modular square root algorithm, so it



unfortunately doesn&#8217;t work on large primes, but hopefully it can be of use and maybe
some fun.
</p><!--l. 409--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a
id="x1-250005.3"></a>Distribution of Orders of Random Elliptic Curves</h4>
<!--l. 413--><p class="noindent" >At this point you might wonder how we know that we can find elliptic curves of the
desired form. Perhaps we have the same problem as we had with Pockington&#8217;s
criterion, and we just described a special purpose primality proving algorithm. Or
perhaps it takes too long to randomly find them.
</p><!--l. 415--><p class="indent" >   It turns out that this really does work, though. The proof that there will always
be an elliptic curve that we can find in expected polynomially many guesses is the
following theorem due to Lenstra:
</p>
<div class="newtheorem">
<!--l. 417--><p class="noindent" ><span class="head">
<span
class="cmbx-10">Theorem</span><span
class="cmbx-10">&#x00A0;4</span> </span><span
class="cmti-10">Let </span><span
class="cmmi-10">p</span><span
class="cmmi-10">&#x2260;</span>2<span
class="cmmi-10">,</span>3 <span
class="cmti-10">prime, and let </span><span
class="cmmi-10">S </span><span
class="cmsy-10">&#x2286;{</span><span
class="cmmi-10">p</span>+1<span
class="cmsy-10">-&#x230A;</span><img
src="proj20x.svg" alt="&#x221A;p"  class="sqrt"  /><span
class="cmsy-10">&#x230B;</span><span
class="cmmi-10">,..,p</span>+1+<span
class="cmsy-10">&#x230A;</span><img
src="proj21x.svg" alt="&#x221A;p"  class="sqrt"  /><span
class="cmsy-10">&#x230B;}</span><span
class="cmti-10">. Let</span>
<span
class="cmmi-10">A</span><span
class="cmti-10">,</span><span
class="cmmi-10">B </span><span
class="cmti-10">be chosen from a uniform random distribution over </span><span
class="msbm-10">F</span><sub><span
class="cmmi-7">p</span></sub><span
class="cmti-10">. Then there exists</span>
<span
class="cmti-10">fixed constants </span><span
class="cmmi-10">k </span><span
class="cmti-10">such that</span>
</p><!--l. 420--><p class="indent" >
</p>
<center class="math-display" >
<img
src="proj22x.svg" alt="                     --k-- -|S|--2--
Prob(#EA,B (Fp) &#x2208; S) &#x003E; log(p)2&#x230A;&#x221A;p&#x230B;+ 1
" class="math-display"  /></center>
</div>
<!--l. 423--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">6   </span> <a
id="x1-260006"></a>Real World Considerations</h3>



<!--l. 425--><p class="noindent" >For all practical purposes, the Primo software by Marcel Martin is the best available
elliptic curve primality prover implementation for general numbers. Although the
algorithm it uses to generate primality certificates is quite complicated, the certificate
itself, and the method of checking it are both quite simple. It only requires a little
more mathematical theory than in this paper, and only a couple hundred lines of
code using a good math library like gmpy2. In fact, several people have actually
created independent checks for Primo&#8217;s certification files, although I have
yet to find any that actually work on the most recent version of Primo. By
pairing this independent checking with Primo&#8217;s builtin verification, one should
be able to rule out implementation errors or hardware failures with a very
high confidence level, easily on par with that of a thorough Miller&#8211;Rabin
test.
</p><!--l. 427--><p class="indent" >   These checks should also be extremely fast. Assuming that the Primo checker is
not taking incorrect shortcuts when verifying the certificate, we should be able to
evaluate it&#8217;s performance checking the certificates as the actual speed of checking
primality. On my machine, using all cores, generating the proof of primality
for the prime (10<sup><span
class="cmr-7">1999</span></sup> + 7321) took 678s. But checking the certificate only
took 0<span
class="cmmi-10">.</span>13 seconds. For comparison, gmpy2&#8217;s <span
class="cmtt-10">is</span><span
class="cmtt-10">_prime </span>function, which uses
Miller&#8211;Rabin, took 0.62 seconds for 6 runs of Miller&#8211;Rabin (the lowest end of
reasonable confidence) and 1.69 seconds for 25 runs (the default). As gmp is well
regarded as a high quality, fast library, and gmp&#8217;s <span
class="cmtt-10">mpz</span><span
class="cmtt-10">_probab</span><span
class="cmtt-10">_prime</span><span
class="cmtt-10">_p </span>(which
gmpy2&#8217;s <span
class="cmtt-10">is</span><span
class="cmtt-10">_prime </span>uses) is actually used in some real world cryptographic
applications, I think it fair to say that checking these elliptic curve primality
certificates can be at least as fast, if not faster than a decent Miller-Rabin
test.
</p><!--l. 429--><p class="indent" >   So hopefully I have shown how deterministic primality testing may have some use
in practical applications as well as explaining the basic theory enough to explore the
topic with some more comfort.
</p><!--l. 444--><p class="noindent" >
</p>
<h3 class="likesectionHead"><a
id="x1-270006"></a>References</h3>
<!--l. 444--><p class="noindent" >
</p><div class="thebibliography">
<p class="bibitem" ><span class="biblabel">
[1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a
id="XStanfordAlgo"></a>Li, Frank. &#8221;Elliptic Curves for Primality Proving.&#8221; SpringerReference
(n.d.):    n.    pag.    Stanford    University,    15    Dec.    2011.    Web.
<a
href="http://theory.stanford.edu/~dfreeman/cs259c-f11/finalpapers/primalityproving.pdf" class="url" ><span
class="cmtt-10">http://theory.stanford.edu/</span><span
class="cmtt-10">~</span><span
class="cmtt-10">dfreeman/cs259c-f11/finalpapers/primalityproving.pdf</span></a>.
</p>
<p class="bibitem" ><span class="biblabel">
[2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a
id="XGoldwasser"></a>Goldwasser,   Shafi,   and   Joe   Kilian.   &#8221;Primality   Testing   Using



Elliptic   Curves.&#8221;   <span
class="cmti-10">Journal  of  the  ACM   </span>46.4   (1999):   450-72.   Web.
<a
href="https://pdfs.semanticscholar.org/997d/f4e2a661aed97b2ad782531aa2ce122cab4d.pdf" class="url" ><span
class="cmtt-10">https://pdfs.semanticscholar.org/997d/f4e2a661aed97b2ad782531aa2ce122cab4d.pdf</span></a>.
</p>
<p class="bibitem" ><span class="biblabel">
[3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a
id="XAtkinMorain"></a>Atkin, A., and F. Morain. &#8221;ELLIPTIC CURVES AND PRIMALITY
PROVING.&#8221;    <span
class="cmti-10">Mathematics   of   Computation    </span>(1993):    29-68.    Web.
<a
href="http://www.ams.org/journals/mcom/1993-61-203/S0025-5718-1993-1199989-X/S0025-5718-1993-1199989-X.pdf" class="url" ><span
class="cmtt-10">http://www.ams.org/journals/mcom/1993-61-203/S0025-5718-1993-1199989-X/S0025-5718-1993-1199989-X.pdf</span></a>.
</p>
</div>

</body></html>
